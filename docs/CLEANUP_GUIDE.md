# Repository Cleanup Guide

## 🎯 Overview

This guide documents the cleanup of the family-tree git repository to remove temporary files, debug scripts, and improve repository hygiene.

## 📊 Current State Analysis

### Files to Remove from Git Tracking

#### 1. **Debug & Test Files (Root Level)**
- `debug_email.py` - Email debugging script
- `debug_tree.js` - Tree debugging script
- `test_email_functionality.py` - One-off email test

#### 2. **Debug Files (Backend)**
- `backend/debug_delete_endpoint.py`
- `backend/debug_endpoint.py`
- `backend/debug_forgot_response.py`
- `backend/debug_routes.py`

#### 3. **One-Time Migration/Utility Scripts (Backend)**
- `backend/migrate_invite_dates.py` - One-time migration
- `backend/migrate_to_spaces.py` - One-time migration
- `backend/fix_test_spaces.py` - One-time fix script
- `backend/cleanup_test_users.py` - Utility script
- `backend/seed_spaces.py` - Data seeding script
- `backend/analyze_data.py` - Analysis script
- `backend/check_openapi.py` - API checking script
- `backend/quick_gmail_test.py` - Gmail testing
- `backend/simple_route_test.py` - Route testing
- `backend/routes_tree_fixed.py` - Old/fixed version
- `backend/run_space_tests.py` - Test runner
- `backend/testgmail.py` - Gmail testing

#### 4. **Test Files in Wrong Location (Backend Root)**
These should be in `backend/tests/` directory:
- `backend/test_comprehensive_spaces.py`
- `backend/test_events.py` (empty)
- `backend/test_gmail_auth.py` (empty)
- `backend/test_hobbies.py` (empty)
- `backend/test_import.py` (empty)
- `backend/test_integration_spaces.py`
- `backend/test_public_invite.py` (empty)
- `backend/test_space_isolation.py`
- `backend/test_tree_bugs.py`

#### 5. **Build/Coverage Artifacts** *(Optional - Skipped by Default)*
- `backend/coverage.xml` - Generated by pytest-cov
- `backend/coverage_badge.py` - Utility script for badge generation

**Note:** These are regenerated by CI/CD automatically. The cleanup script skips this step by default. To remove them, run: `CLEAN_COVERAGE=1 ./cleanup-repo.sh`

#### 6. **Work-in-Progress Documentation**
- `INSTAGRAM_INTEGRATION.md` - Feature doc (can be moved to docs/ when complete)
- `FAMILY_SPACES_SETUP.md` - Setup doc (can be moved to docs/ when complete)

### Files Already Ignored (but present locally)
- `.DS_Store` - macOS file
- `__pycache__/` - Python cache
- `.pytest_cache/` - Pytest cache
- `.coverage` - Coverage data
- `.ruff_cache/` - Ruff cache
- `.mypy_cache/` - MyPy cache

## 🚀 Cleanup Process

### Option 1: Automated Cleanup (Recommended)

Run the provided cleanup script:

```bash
cd /Users/r39132/Projects/family-tree
./cleanup-repo.sh

# Optional: Also remove coverage artifacts
# CLEAN_COVERAGE=1 ./cleanup-repo.sh
```

This will:
1. Remove all tracked debug/temp files from git
2. Clean up local cache files
3. Update .gitignore to prevent re-addition
4. Skip coverage artifacts by default (use CLEAN_COVERAGE=1 to remove them)

### Option 2: Manual Cleanup

If you prefer manual control:

```bash
# 1. Remove debug files from git tracking
git rm --cached debug_email.py debug_tree.js test_email_functionality.py
git rm --cached backend/debug_*.py

# 2. Remove migration/utility scripts
git rm --cached backend/migrate_*.py backend/fix_*.py backend/seed_*.py
git rm --cached backend/analyze_*.py backend/check_*.py backend/cleanup_*.py
git rm --cached backend/quick_*.py backend/simple_*.py
git rm --cached backend/routes_tree_fixed.py backend/run_space_tests.py
git rm --cached backend/testgmail.py

# 3. Remove misplaced test files
git rm --cached backend/test_*.py

# 4. Remove build artifacts
git rm --cached backend/coverage.xml backend/coverage_badge.py

# 5. Remove WIP documentation (optional)
git rm --cached INSTAGRAM_INTEGRATION.md FAMILY_SPACES_SETUP.md

# 6. Clean local files
find . -name ".DS_Store" -delete
find . -type d -name "__pycache__" -exec rm -rf {} +
find . -name "*.pyc" -delete
find . -type d -name ".pytest_cache" -exec rm -rf {} +
```

## 📝 After Cleanup

### 1. Review Changes
```bash
git status
```

### 2. Commit the Cleanup
```bash
git commit -m "chore: cleanup debug files, temp scripts, and build artifacts

- Remove debug scripts from root and backend
- Remove one-time migration scripts
- Remove misplaced test files (should be in tests/)
- Remove coverage artifacts
- Update .gitignore to prevent re-addition
- Clean local cache files"
```

### 3. Push to Remote
```bash
git push origin main
```

## 📁 Recommended File Organization

### Backend Directory Structure
```
backend/
├── app/              # Application code
│   ├── __init__.py
│   ├── main.py
│   ├── models.py
│   ├── routes_*.py
│   ├── config.py
│   ├── deps.py
│   └── utils/
├── tests/            # All test files
│   ├── __init__.py
│   ├── test_*.py
│   └── conftest.py
├── scripts/          # Utility scripts (not tracked)
│   ├── migrate_*.py
│   ├── seed_*.py
│   └── debug_*.py
├── pyproject.toml
├── uv.lock
├── Dockerfile
└── .env.example
```

### Root Directory
```
family-tree/
├── backend/
├── frontend/
├── docs/            # All documentation
├── .github/         # GitHub workflows
├── docker-compose.yml
├── README.md
├── LICENSE
├── .gitignore
└── setup-dev-tools.sh
```

## 🎯 Benefits of Cleanup

1. **Cleaner Repository** - Easier to navigate and understand
2. **Faster Clones** - Smaller repository size
3. **Better History** - Relevant commits only
4. **Improved Collaboration** - Clear structure for contributors
5. **No Confusion** - Debug scripts won't be mistaken for production code

## 🔐 Files That Should Stay

### Backend
- `app/` directory - All application code
- `tests/` directory - Proper test suite
- `pyproject.toml` - Dependencies
- `uv.lock` - Lock file
- `Dockerfile` - Container config
- `.env.example` - Environment template

### Frontend
- All source code in proper structure
- `package.json` - Dependencies
- Configuration files

### Documentation
- `README.md`
- `LICENSE`
- `docs/` directory contents
- `.github/workflows/` - CI/CD

## 📌 Important Notes

1. **Files Stay Local** - Removed files are still on your disk, just not tracked by git
2. **Can Be Recovered** - If needed, files can be recovered from git history
3. **Scripts Directory** - Consider creating `backend/scripts/` for utility scripts (not tracked)
4. **Documentation** - Move completed docs to `docs/` directory

## 🔄 Ongoing Maintenance

### Prevent Future Clutter

1. **Use scripts/ directory** for one-off scripts
2. **Keep tests in tests/** directory only
3. **Remove debug code** before committing
4. **Review .gitignore** regularly
5. **Run cleanup** periodically:
   ```bash
   find . -name ".DS_Store" -delete
   find . -type d -name "__pycache__" -exec rm -rf {} +
   ```

### Pre-Commit Hook

Add to `.git/hooks/pre-commit`:
```bash
#!/bin/bash
# Prevent committing debug files
if git diff --cached --name-only | grep -E "(debug_|temp_|tmp_)"; then
    echo "❌ Error: Attempting to commit debug/temp files"
    echo "Please remove or add to .gitignore"
    exit 1
fi
```

## 📚 Related Documentation

- [Contributing Guide](docs/CONTRIBUTING.md)
- [Architecture Overview](docs/ARCHITECTURE.md)
- [Deployment Guide](docs/DEPLOYMENT.md)

---

**Last Updated**: October 5, 2025
**Repository**: r39132/family-tree
**Status**: Ready for cleanup
